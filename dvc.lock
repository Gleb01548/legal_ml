schema: '2.0'
stages:
  convert_data:
    cmd: python -m src.pipeline.01_pipeline_convert_zst_to_parquet
    deps:
    - path: ./data/raw/questions.json.zst
      hash: md5
      md5: 17c42c56fe83c7b8034ea5200a331b1d
      size: 2927732727
    - path: ./src/data/convert_zst_to_perquet_9111_df.py
      hash: md5
      md5: 19194601e6f080966a5cc53a35a23163
      size: 1192
    outs:
    - path: ./data/interim/split_9111_dataset/
      hash: md5
      md5: d751713988987e9331980363e24189ce.dir
      size: 0
      nfiles: 0
  prepare_data:
    cmd: python -m src.pipeline.02_pipeline_prepare_dataset_for_vectorization
    deps:
    - path: ./data/interim/split_9111_dataset/
      hash: md5
      md5: d751713988987e9331980363e24189ce.dir
      size: 0
      nfiles: 0
    - path: ./src/data/prepare_dataset_for_vectorization.py
      hash: md5
      md5: 93429e4d5a0487c1c67de6e8940dcf65
      size: 3648
    outs:
    - path: ./data/interim/question_answer_dataset/
      hash: md5
      md5: d751713988987e9331980363e24189ce.dir
      size: 0
      nfiles: 0
  load_data_in_vector_db:
    cmd: python -m src.pipeline.03_pipeline_load_data_in_vector_db --collection_name
      911_hybrid_rating_points --min_rating 0.1
    deps:
    - path: ./data/interim/question_answer_dataset/
      hash: md5
      md5: d751713988987e9331980363e24189ce.dir
      size: 0
      nfiles: 0
    - path: ./src/containers/embeddings_model.py
      hash: md5
      md5: 8c80c29fb6780f28862fbd4f057821b6
      size: 1306
    - path: ./src/data/load_data_in_vector_db.py
      hash: md5
      md5: 4b690ccfd6028b278c54b15ad2936621
      size: 5620
    outs:
    - path: ./data/interim/save_time_load_dataset_in_vector_db/
      hash: md5
      md5: c3190e5d5278d2d82e196b4d5579fdc0.dir
      size: 0
      nfiles: 1
  create_prompt_dataset:
    cmd: python -m src.pipeline.pipeline_create_prompt_dataset --num_examples_for_train
      10000 --rating_more 8 --path_save_dataset ./data/processed/10k_8_qwen
    deps:
    - path: ./data/interim/save_time_load_dataset_in_vector_db/
      hash: md5
      md5: 25e808360cb112e76ee257e0741e8f8b.dir
      size: 0
      nfiles: 1
    - path: ./src/features/create_prompt_dataset.py
      hash: md5
      md5: 2c75830369abca8bce3177995211bda9
      size: 4498
    outs:
    - path: ./data/processed/10k_8_qwen
      hash: md5
      md5: efdb7f028ce3eae52293bd35a210b2c4.dir
      size: 101079322
      nfiles: 7
  sample_records_from_collection:
    cmd: python -m src.pipeline.04_pipeline_sample_records_from_collection --collection_name
      911_hybrid_rating_points --path_save ./data/interim/data_param_tunning/points.csv
    deps:
    - path: ./data/interim/save_time_load_dataset_in_vector_db/
      hash: md5
      md5: c3190e5d5278d2d82e196b4d5579fdc0.dir
      size: 0
      nfiles: 1
    - path: ./src/data/sample_records_from_collection.py
      hash: md5
      md5: 9bfc62d09e7f835044f5e4cac139a57e
      size: 743
    outs:
    - path: ./data/interim/data_param_tunning/points.csv
      hash: md5
      md5: 3499f63a180a2636415681cb9d170e06
      size: 11
  create_data_records:
    cmd: python -m src.pipeline.pipeline_create_data_records --collection_name 911_hybrid_rating_points
    deps:
    - path: ./data/interim/data_param_tunning/points.csv
      hash: md5
      md5: c1becab8263fb60d55593052bee423e6
      size: 195303
    - path: ./src/features/create_data_records.py
      hash: md5
      md5: e215c74fe6ecd86e13ec0790702aed99
      size: 3753
    - path: ./src/features/retrievers.py
      hash: md5
      md5: 917e3984173017b7c6708bb69606a3f2
      size: 2612
    - path: ./src/pipeline/pipeline_create_data_records.py
      hash: md5
      md5: 4d3698a8f3597a832e67ee6990e895e8
      size: 2700
    outs:
    - path: ./data/interim/data_param_tunning/data_records.parquet
      hash: md5
      md5: 6294ad396c13a308c9193197dd80b270
      size: 195652702
  create_data_prompts:
    cmd: python -m src.pipeline.pipeline_create_prompt
    deps:
    - path: ./data/interim/data_param_tunning/data_records.parquet
      hash: md5
      md5: 6294ad396c13a308c9193197dd80b270
      size: 195652702
    - path: ./src/pipeline/pipeline_create_prompt.py
      hash: md5
      md5: 2c83b366b55c618941811a59dcfdeea9
      size: 2415
    outs:
    - path: ./data/interim/data_param_tunning/data_prompts.parquet
      hash: md5
      md5: 158b08ed391f80b52c9481b2b6667345
      size: 100806573
